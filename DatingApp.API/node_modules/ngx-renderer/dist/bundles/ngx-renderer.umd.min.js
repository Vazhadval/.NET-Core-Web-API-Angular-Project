!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports,require("@angular/core"),require("@angular/platform-webworker"),require("@angular/platform-webworker/src/web_workers/shared/serializer")):"function"==typeof define&&define.amd?define(["exports","@angular/core","@angular/platform-webworker","@angular/platform-webworker/src/web_workers/shared/serializer"],factory):factory(global.ngxRenderer={},global.ng.core,global.ng.platformWebworker,global.ng["platformWebworker/src/web_workers/shared/serializer"])}(this,function(exports,_angular_core,_angular_platformWebworker,_angular_platformWebworker_src_web_workers_shared_serializer){"use strict";function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}function literalExpression(value){return{__expr_type:ExpressionType.Literal,value:value}}function elementExpression(element){return{__expr_type:ExpressionType.Element,value:element}}function callExpression(method,args){return{__expr_type:ExpressionType.Call,method:method,args:args}}function isExpression(obj){return obj&&void 0!==obj.__expr_type}function isExpressionOfType(type,expr){return expr&&expr.__expr_type===type}function initUiRenderer(renderer){return function(){return renderer.setup()}}var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])},AdvancedRendererMethod={};AdvancedRendererMethod.execute=0,AdvancedRendererMethod.invokeElementMethod=1,AdvancedRendererMethod.invokeGlobalTargetMethod=2,AdvancedRendererMethod.setGlobalTargetPropery=3,AdvancedRendererMethod.getGlobalTargetProperty=4,AdvancedRendererMethod[AdvancedRendererMethod.execute]="execute",AdvancedRendererMethod[AdvancedRendererMethod.invokeElementMethod]="invokeElementMethod",AdvancedRendererMethod[AdvancedRendererMethod.invokeGlobalTargetMethod]="invokeGlobalTargetMethod",AdvancedRendererMethod[AdvancedRendererMethod.setGlobalTargetPropery]="setGlobalTargetPropery",AdvancedRendererMethod[AdvancedRendererMethod.getGlobalTargetProperty]="getGlobalTargetProperty";var AdvancedRenderer=function(){function AdvancedRenderer(){}return AdvancedRenderer.prototype.execute=function(expression,args){},AdvancedRenderer.prototype.invokeElementMethod=function(element,method,args){},AdvancedRenderer.prototype.invokeGlobalTargetMethod=function(target,method,args){},AdvancedRenderer.prototype.setGlobalTargetPropery=function(target,prop,value){},AdvancedRenderer.prototype.getGlobalTargetProperty=function(target,prop){},AdvancedRenderer.prototype.getMethod=function(method){switch(method){case AdvancedRendererMethod.execute:return this.execute;case AdvancedRendererMethod.getGlobalTargetProperty:return this.getGlobalTargetProperty;case AdvancedRendererMethod.invokeElementMethod:return this.invokeElementMethod;case AdvancedRendererMethod.invokeGlobalTargetMethod:return this.invokeGlobalTargetMethod;case AdvancedRendererMethod.setGlobalTargetPropery:return this.setGlobalTargetPropery;default:throw Error("AdvancedRenderer: Unkown method ["+method+"]")}},AdvancedRenderer}(),ExpressionType={};ExpressionType.Abstract=0,ExpressionType.Literal=1,ExpressionType.Call=2,ExpressionType.Element=3,ExpressionType[ExpressionType.Abstract]="Abstract",ExpressionType[ExpressionType.Literal]="Literal",ExpressionType[ExpressionType.Call]="Call",ExpressionType[ExpressionType.Element]="Element";var isLiteralExpression=isExpressionOfType.bind(null,ExpressionType.Literal),isElementExpression=isExpressionOfType.bind(null,ExpressionType.Element),isCallExpression=isExpressionOfType.bind(null,ExpressionType.Call),AdvancedRendererImpl=function(_super){function AdvancedRendererImpl(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AdvancedRendererImpl,_super),AdvancedRendererImpl.prototype.execute=function(expression,args){var _a=this._resolveArgs(args),argNames=_a.argNames,argsResolved=_a.argsResolved,fn=new Function(argNames.join(","),expression);return Promise.resolve().then(function(){return fn.apply(void 0,argsResolved)})},AdvancedRendererImpl.prototype.invokeElementMethod=function(element,method,args){return this.execute("return element."+method+".apply(element, args)",{element:element,args:args})},AdvancedRendererImpl.prototype.invokeGlobalTargetMethod=function(target,method,args){return this.execute("return "+target+"."+method+".apply("+target+", args)",{args:args})},AdvancedRendererImpl.prototype.setGlobalTargetPropery=function(target,prop,value){this.execute(target+"."+prop+" = value",{value:value})},AdvancedRendererImpl.prototype.getGlobalTargetProperty=function(target,prop){return this.execute("return "+target+"."+prop)},AdvancedRendererImpl.prototype._resolveArgs=function(args){void 0===args&&(args={});var argNames=Object.keys(args);return{argNames:argNames,argsResolved:this._resolveArgsArray(argNames.map(function(name){return args[name]}))}},AdvancedRendererImpl.prototype._resolveArgsArray=function(args){var _this=this;return args.map(function(arg){return _this._resolveExpression(arg)})},AdvancedRendererImpl.prototype._resolveExpression=function(expr){if(isExpression(expr)){if(isLiteralExpression(expr)||isElementExpression(expr))return expr.value;if(isCallExpression(expr))return this.getMethod(expr.method).apply(void 0,this._resolveArgsArray(expr.args));throw Error("Unknown expression type '"+expr.__expr_type+"'")}return expr},AdvancedRendererImpl}(AdvancedRenderer);AdvancedRendererImpl.decorators=[{type:_angular_core.Injectable}],AdvancedRendererImpl.ctorParameters=function(){return[]};var ADVANCED_RENDERER_PROVIDERS=[{provide:AdvancedRenderer,useClass:AdvancedRendererImpl}],AdvancedRendererModule=function(){function AdvancedRendererModule(){}return AdvancedRendererModule}();AdvancedRendererModule.decorators=[{type:_angular_core.NgModule,args:[{providers:ADVANCED_RENDERER_PROVIDERS}]}],AdvancedRendererModule.ctorParameters=function(){return[]};var RENDERER_CHANNEL="RENDERER_CHANNEL",AdvancedRendererWorker=function(_super){function AdvancedRendererWorker(brokerFactory){var _this=_super.call(this)||this;return _this.brokerFactory=brokerFactory,_this.broker=_this.brokerFactory.createMessageBroker(RENDERER_CHANNEL,!1),_this}return __extends(AdvancedRendererWorker,_super),AdvancedRendererWorker.prototype.execute=function(expression,args){return this._callTask(AdvancedRendererMethod.execute,[expression,args])},AdvancedRendererWorker.prototype.invokeElementMethod=function(element,method,args){return this._callTask(AdvancedRendererMethod.invokeElementMethod,[elementExpression(element),method,args])},AdvancedRendererWorker.prototype.invokeGlobalTargetMethod=function(target,method,args){return this._callTask(AdvancedRendererMethod.invokeGlobalTargetMethod,[target,method,args])},AdvancedRendererWorker.prototype.setGlobalTargetPropery=function(target,prop,value){this._callTask(AdvancedRendererMethod.setGlobalTargetPropery,[target,prop,value])},AdvancedRendererWorker.prototype.getGlobalTargetProperty=function(target,prop){return this._callTask(AdvancedRendererMethod.getGlobalTargetProperty,[target,prop])},AdvancedRendererWorker.prototype._callTask=function(task,args){var taskArg=new _angular_platformWebworker.FnArg(task,1),argsArg=new _angular_platformWebworker.FnArg(args,1),uiArgs=new _angular_platformWebworker.UiArguments("RENDERER_CALL_TASK",[taskArg,argsArg]);return this.broker.runOnService(uiArgs,1)},AdvancedRendererWorker}(AdvancedRenderer);AdvancedRendererWorker.decorators=[{type:_angular_core.Injectable}],AdvancedRendererWorker.ctorParameters=function(){return[{type:_angular_platformWebworker.ClientMessageBrokerFactory}]};var AdvancedRendererWorkerModule=function(){function AdvancedRendererWorkerModule(){}return AdvancedRendererWorkerModule}();AdvancedRendererWorkerModule.decorators=[{type:_angular_core.NgModule,args:[{providers:[{provide:AdvancedRenderer,useClass:AdvancedRendererWorker}]}]}],AdvancedRendererWorkerModule.ctorParameters=function(){return[]};var AdvancedRendererUi=function(){function AdvancedRendererUi(brokerFactory,renderer,serializer){this.brokerFactory=brokerFactory,this.renderer=renderer,this.serializer=serializer,this.broker=this.brokerFactory.createMessageBroker(RENDERER_CHANNEL,!1)}return AdvancedRendererUi.prototype.setup=function(){this.broker.registerMethod("RENDERER_CALL_TASK",[1,1],this._callTask.bind(this),1)},AdvancedRendererUi.prototype._callTask=function(task,args){return this.renderer.getMethod(task).apply(void 0,this._deserializeArgs(args))},AdvancedRendererUi.prototype._deserializeArgs=function(arg){var _this=this;return Array.isArray(arg)?arg.map(function(a){return _this._deserializeArgs(a)}):("object"==typeof arg&&(isElementExpression(arg)?arg.value=this.serializer.deserialize(arg.value,2):Object.keys(arg||{}).forEach(function(key){return arg[key]=_this._deserializeArgs(arg[key])})),arg)},AdvancedRendererUi}();AdvancedRendererUi.decorators=[{type:_angular_core.Injectable}],AdvancedRendererUi.ctorParameters=function(){return[{type:_angular_platformWebworker.ServiceMessageBrokerFactory},{type:AdvancedRenderer},{type:_angular_platformWebworker_src_web_workers_shared_serializer.Serializer}]};var ADVANCED_RENDERER_UI_PROVIDERS=[ADVANCED_RENDERER_PROVIDERS,AdvancedRendererUi,{provide:_angular_core.PLATFORM_INITIALIZER,useFactory:initUiRenderer,deps:[AdvancedRendererUi],multi:!0}],AdvancedRendererNoop=function(_super){function AdvancedRendererNoop(){return null!==_super&&_super.apply(this,arguments)||this}return __extends(AdvancedRendererNoop,_super),AdvancedRendererNoop.prototype.execute=function(expression,args){return Promise.resolve()},AdvancedRendererNoop.prototype.invokeElementMethod=function(element,method,args){return Promise.resolve()},AdvancedRendererNoop.prototype.invokeGlobalTargetMethod=function(target,method,args){return Promise.resolve()},AdvancedRendererNoop.prototype.setGlobalTargetPropery=function(target,prop,value){},AdvancedRendererNoop.prototype.getGlobalTargetProperty=function(target,prop){return Promise.resolve()},AdvancedRendererNoop}(AdvancedRenderer);AdvancedRendererNoop.decorators=[{type:_angular_core.Injectable}],AdvancedRendererNoop.ctorParameters=function(){return[]};var AdvancedRendererNoopModule=function(){function AdvancedRendererNoopModule(){}return AdvancedRendererNoopModule}();AdvancedRendererNoopModule.decorators=[{type:_angular_core.NgModule,args:[{providers:[{provide:AdvancedRenderer,useClass:AdvancedRendererNoop}]}]}],AdvancedRendererNoopModule.ctorParameters=function(){return[]},exports.AdvancedRendererMethod=AdvancedRendererMethod,exports.AdvancedRenderer=AdvancedRenderer,exports.ExpressionType=ExpressionType,exports.literalExpression=literalExpression,exports.elementExpression=elementExpression,exports.callExpression=callExpression,exports.isExpression=isExpression,exports.isExpressionOfType=isExpressionOfType,exports.isLiteralExpression=isLiteralExpression,exports.isElementExpression=isElementExpression,exports.isCallExpression=isCallExpression,exports.AdvancedRendererModule=AdvancedRendererModule,exports.AdvancedRendererWorkerModule=AdvancedRendererWorkerModule,exports.initUiRenderer=initUiRenderer,exports.ADVANCED_RENDERER_UI_PROVIDERS=ADVANCED_RENDERER_UI_PROVIDERS,exports.AdvancedRendererNoopModule=AdvancedRendererNoopModule,exports.ɵb=ADVANCED_RENDERER_PROVIDERS,exports.ɵa=AdvancedRendererImpl,exports.ɵe=AdvancedRendererNoop,exports.ɵd=AdvancedRendererUi,exports.ɵc=AdvancedRendererWorker,Object.defineProperty(exports,"__esModule",{value:!0})});